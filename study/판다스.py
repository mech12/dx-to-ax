import pandas as pd
import numpy as np

# 1. 데이터 정의
data = {
    '이름': ['김철수', '이영희', '박민수', '최지아'],
    '나이': [25, 30, 22, 28],
    '도시': ['서울', '부산', '서울', '제주'],
    '국어점수': [88.5, 92.0, 75.5, 98.0],
    '수학점수': [81.5, 72.0, 85.5, 98.0]
}

# 2. 데이터프레임 생성
df = pd.DataFrame(data)
print("--- 1. 원본 데이터프레임 ---")
print(df)

# 3. 데이터프레임 구조 확인
print("\n--- 2. 데이터 구조 및 타입 확인 (info()) ---")
df.info()

# 4. 새로운 열 (컬럼) 생성
# 4-1. 총점 계산: 국어점수 + 수학점수
df['총점'] = df['국어점수'] + df['수학점수']

# 4-2. 평균 계산
df['평균'] = df['총점'] / 2

# 4-3. 조건에 따른 열 생성 ( Numpy의 where 함수 사용)
# 평균이 90점 이상이면 'A', 아니면 'B' 등급 부여
df['등급'] = np.where(df['평균'] >= 90, 'A', 
                     np.where(df['평균'] >= 80, 'B', 'C'))
print("\n--- 3. 총점, 평균, 등급 열 추가 후 ---")
print(df)

# 5. 통계 요약 (describe)
print("\n--- 4. 점수 열에 대한 통계 요약 (describe()) ---")
print(df[['국어점수', '수학점수', '총점', '평균']].describe().T) # .T는 행/열 전환

# 6. 데이터 필터링 (조건에 맞는 행 추출)
# 6-1. 서울에 거주하는 학생들만 추출
서울_학생 = df[df['도시'] == '서울']
print("\n--- 5. 서울 거주 학생 데이터 ---")
print(서울_학생)

# 6-2. 평균이 85점 이상인 학생들만 추출
고득점자 = df[df['평균'] >= 85]
print("\n--- 6. 평균 85점 이상 고득점자 ---")
print(고득점자)

# 7. 데이터 정렬 (Sort)
# 총점 기준으로 내림차순 정렬
df_sorted = df.sort_values(by='총점', ascending=False)
print("\n--- 7. 총점 기준 내림차순 정렬 ---")
print(df_sorted)

# 8. 그룹화 및 집계 (GroupBy)
# 도시별 평균 나이와 평균 점수를 계산
도시별_통계 = df.groupby('도시').agg({
    '나이': 'mean',          # 도시별 평균 나이
    '국어점수': 'mean',      # 도시별 국어 평균
    '수학점수': 'mean',      # 도시별 수학 평균
    '이름': 'count'         # 도시별 학생 수
}).rename(columns={'이름': '학생수'})

print("\n--- 8. 도시별 통계 (GroupBy) ---")
print(도시별_통계)